package server

import (
	"encoding/base64"
	"testing"

	"github.com/schidstorm/scanner-tool/pkg/filequeue"
	"github.com/sirupsen/logrus"
	"github.com/stretchr/testify/assert"
)

func TestTesseractHandler(t *testing.T) {
	page1 := "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UmaRMjmvK5G4RG7qzNXOD5lPyPenzDVyyTM3yFWBfW4Vc8d8kp9NqFpDSFvg3XD8PLix8Hta73x24fsGuxV49QplbmRzdHJlYW0KZW5kb2JqCgo5IDAgb2JqCjw8L1R5cGUvRm9udC9TdWJ0eXBlL1RydWVUeXBlL0Jhc2VGb250L0JBQUFBQStMaWJlcmF0aW9uU2VyaWYKL0ZpcnN0Q2hhciAwCi9MYXN0Q2hhciA2Ci9XaWR0aHNbMCA1NTYgNDQzIDI3NyAyNzcgMjUwIDUwMCBdCi9Gb250RGVzY3JpcHRvciA3IDAgUgovVG9Vbmljb2RlIDggMCBSCj4+CmVuZG9iagoKMTAgMCBvYmoKPDwvRjEgOSAwIFIKPj4KZW5kb2JqCgoxMSAwIG9iago8PAovRm9udCAxMCAwIFIKL1Byb2NTZXRbL1BERi9UZXh0XQo+PgplbmRvYmoKCjEgMCBvYmoKPDwvVHlwZS9QYWdlL1BhcmVudCA0IDAgUi9SZXNvdXJjZXMgMTEgMCBSL01lZGlhQm94WzAgMCA1OTUgODQyXS9Sb3RhdGUgMAovQ29udGVudHMgMiAwIFI+PgplbmRvYmoKCjQgMCBvYmoKPDwvVHlwZS9QYWdlcwovUmVzb3VyY2VzIDExIDAgUgovS2lkc1sgMSAwIFIgXQovQ291bnQgMT4+CmVuZG9iagoKMTIgMCBvYmoKPDwvVHlwZS9DYXRhbG9nL1BhZ2VzIDQgMCBSCi9WaWV3ZXJQcmVmZXJlbmNlczw8L0Rpc3BsYXlEb2NUaXRsZSB0cnVlCj4+Ci9MYW5nKGRlLURFKQo+PgplbmRvYmoKCjEzIDAgb2JqCjw8L1RpdGxlPEZFRkYwMDU1MDA2RTAwNzQwMDY5MDA3NDAwNkMwMDY1MDA2NDAwMjAwMDMxPgovQ3JlYXRvcjxGRUZGMDA0QzAwNjkwMDYyMDA3MjAwNjUwMDRGMDA2NjAwNjYwMDY5MDA2MzAwNjUwMDIwMDAzMjAwMzQwMDJFMDAzMjAwMkUwMDM3MDAyRTAwMzI+Ci9Qcm9kdWNlcjxGRUZGMDA0QzAwNjkwMDYyMDA3MjAwNjUwMDRGMDA2NjAwNjYwMDY5MDA2MzAwNjUwMDIwMDAzMjAwMzQwMDJFMDAzMjAwMkUwMDM3MDAyRTAwMzI+Ci9DcmVhdGlvbkRhdGUoRDoyMDI1MDgwMTE4MTgwNSswMicwMCcpPj4KZW5kb2JqCgp4cmVmCjAgMTQKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDA1NzUyIDAwMDAwIG4gCjAwMDAwMDAwMTkgMDAwMDAgbiAKMDAwMDAwMDE2MiAwMDAwMCBuIAowMDAwMDA1ODYwIDAwMDAwIG4gCjAwMDAwMDAxODEgMDAwMDAgbiAKMDAwMDAwNDk0NyAwMDAwMCBuIAowMDAwMDA0OTY4IDAwMDAwIG4gCjAwMDAwMDUxNjMgMDAwMDAgbiAKMDAwMDAwNTQ4MyAwMDAwMCBuIAowMDAwMDA1NjY0IDAwMDAwIG4gCjAwMDAwMDU2OTYgMDAwMDAgbiAKMDAwMDAwNTkzNCAwMDAwMCBuIAowMDAwMDA2MDQwIDAwMDAwIG4gCnRyYWlsZXIKPDwvU2l6ZSAxNC9Sb290IDEyIDAgUgovSW5mbyAxMyAwIFIKL0lEIFsgPDYwODVCMTVCNkM5MDI2NEE1QzI3MEYzQTFFRjVFM0NBPgo8NjA4NUIxNUI2QzkwMjY0QTVDMjcwRjNBMUVGNUUzQ0E+IF0KL0RvY0NoZWNrc3VtIC9DMzlCNENBODFDNUFCRDUxNEFGNDEyNjFDNzIxNjg0QQo+PgpzdGFydHhyZWYKNjM0NAolJUVPRgo="
	page2 := "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P8sZGLqOnU5hE7djsvwlvG8eaIm62EdRTsPipYIg7QSk5VzQ9noVBKz+F2t2xzCqTxlSZpEyOa8rkbhEburM1c4PmU/I96fMNXLJMzfIVYl9bhVzx3ySn02oWkNIW+DdcPw8uLHwe1rvfHbh+wa7YHj2CmVuZHN0cmVhbQplbmRvYmoKCjkgMCBvYmoKPDwvVHlwZS9Gb250L1N1YnR5cGUvVHJ1ZVR5cGUvQmFzZUZvbnQvQkFBQUFBK0xpYmVyYXRpb25TZXJpZgovRmlyc3RDaGFyIDAKL0xhc3RDaGFyIDYKL1dpZHRoc1swIDU1NiA0NDMgMjc3IDI3NyAyNTAgNTAwIF0KL0ZvbnREZXNjcmlwdG9yIDcgMCBSCi9Ub1VuaWNvZGUgOCAwIFIKPj4KZW5kb2JqCgoxMCAwIG9iago8PC9GMSA5IDAgUgo+PgplbmRvYmoKCjExIDAgb2JqCjw8Ci9Gb250IDEwIDAgUgovUHJvY1NldFsvUERGL1RleHRdCj4+CmVuZG9iagoKMSAwIG9iago8PC9UeXBlL1BhZ2UvUGFyZW50IDQgMCBSL1Jlc291cmNlcyAxMSAwIFIvTWVkaWFCb3hbMCAwIDU5NSA4NDJdL1JvdGF0ZSAwCi9Db250ZW50cyAyIDAgUj4+CmVuZG9iagoKNCAwIG9iago8PC9UeXBlL1BhZ2VzCi9SZXNvdXJjZXMgMTEgMCBSCi9LaWRzWyAxIDAgUiBdCi9Db3VudCAxPj4KZW5kb2JqCgoxMiAwIG9iago8PC9UeXBlL0NhdGFsb2cvUGFnZXMgNCAwIFIKL1ZpZXdlclByZWZlcmVuY2VzPDwvRGlzcGxheURvY1RpdGxlIHRydWUKPj4KL0xhbmcoZGUtREUpCj4+CmVuZG9iagoKMTMgMCBvYmoKPDwvVGl0bGU8RkVGRjAwNTUwMDZFMDA3NDAwNjkwMDc0MDA2QzAwNjUwMDY0MDAyMDAwMzE+Ci9DcmVhdG9yPEZFRkYwMDRDMDA2OTAwNjIwMDcyMDA2NTAwNEYwMDY2MDA2NjAwNjkwMDYzMDA2NTAwMjAwMDMyMDAzNDAwMkUwMDMyMDAyRTAwMzcwMDJFMDAzMj4KL1Byb2R1Y2VyPEZFRkYwMDRDMDA2OTAwNjIwMDcyMDA2NTAwNEYwMDY2MDA2NjAwNjkwMDYzMDA2NTAwMjAwMDMyMDAzNDAwMkUwMDMyMDAyRTAwMzcwMDJFMDAzMj4KL0NyZWF0aW9uRGF0ZShEOjIwMjUwODAxMTgxODI0KzAyJzAwJyk+PgplbmRvYmoKCnhyZWYKMCAxNAowMDAwMDAwMDAwIDY1NTM1IGYgCjAwMDAwMDU4MDIgMDAwMDAgbiAKMDAwMDAwMDAxOSAwMDAwMCBuIAowMDAwMDAwMTYyIDAwMDAwIG4gCjAwMDAwMDU5MTAgMDAwMDAgbiAKMDAwMDAwMDE4MSAwMDAwMCBuIAowMDAwMDA0OTk3IDAwMDAwIG4gCjAwMDAwMDUwMTggMDAwMDAgbiAKMDAwMDAwNTIxMyAwMDAwMCBuIAowMDAwMDA1NTMzIDAwMDAwIG4gCjAwMDAwMDU3MTQgMDAwMDAgbiAKMDAwMDAwNTc0NiAwMDAwMCBuIAowMDAwMDA1OTg0IDAwMDAwIG4gCjAwMDAwMDYwOTAgMDAwMDAgbiAKdHJhaWxlcgo8PC9TaXplIDE0L1Jvb3QgMTIgMCBSCi9JbmZvIDEzIDAgUgovSUQgWyA8OTBBQjk4Njc0M0IwMUIzQUI5RkUyRjUyQzU1MTQxMjU+Cjw5MEFCOTg2NzQzQjAxQjNBQjlGRTJGNTJDNTUxNDEyNT4gXQovRG9jQ2hlY2tzdW0gLzkwQjQ3MjEyQ0ZGRDE3M0Y5QjQwNjU1NkRCMTlGQTFECj4+CnN0YXJ0eHJlZgo2Mzk0CiUlRU9GCg=="

	page1Data, _ := base64.StdEncoding.DecodeString(page1)
	page2Data, _ := base64.StdEncoding.DecodeString(page2)

	resultFiles := prepareHandlerThings(t, map[string][]byte{
		"page1.pdf": page1Data,
		"page2.pdf": page2Data,
	}, func(file filequeue.QueueFile, outputQueue filequeue.Queue) error {
		handler := &MergeHandler{}
		return handler.Run(logrus.New(), file, outputQueue)
	})

	assert.Equal(t, 1, len(resultFiles))
}
